# 決定事項の判定と記録ルール

## 目的

**後で見返したときに、何をどう決めたか迷わない状態にする。**

決定事項の記録は「記録すること」自体が目的ではない。曖昧さを排除し、将来の自分や他のエージェントが同じ認識を持てるようにすることが本質。

---

## 記録のタイミング

```
1. エージェント: 認識合わせを行う
   ↓
2. ユーザー: 「OK」「合ってる」「それでいい」
   ↓
3. エージェント: 即座に add_decision() で記録
```

**重要:**
- 「後でまとめて記録」はNG → 忘れる、漏れる、曖昧になる
- ユーザーが承認した直後に記録する
- 記録したら「決定事項として記録したよ」と伝える

---

## 決定事項とは

エージェントが認識合わせを行い、ユーザーが承認したタイミングで確定するもの。

### 記録すべきもの

- 仕様・設計の方針（「〇〇方式で実装する」）
- 技術選定（「ライブラリはXを使う」）
- 優先順位・スコープ（「v1では〇〇は対象外」）
- 命名・規約（「変数名は camelCase」）
- トレードオフの選択（「パフォーマンスより可読性を優先」）

### 記録すべきでないもの

- 単なる事実の確認（「このファイルは存在する」）
- 一時的な作業指示（「まずこのファイルを読んで」）
- 自明な実装詳細（「forループを使う」）
- ユーザーの感想・コメント（「いいね」「なるほど」）

---

## 曖昧さを排除する書き方

### 良い例

| 曖昧 ❌ | 明確 ✅ |
|--------|--------|
| 「パフォーマンスを考慮する」 | 「100ms以内のレスポンスを目標とする」 |
| 「シンプルに実装する」 | 「外部ライブラリを使わず標準ライブラリのみで実装する」 |
| 「後で対応する」 | 「v2のスコープとし、v1では対象外」 |
| 「適切にエラーハンドリングする」 | 「エラー時はログ出力し、nullを返す」 |

### 書き方のチェックリスト

記録する前に確認：
- [ ] 具体的な数値・名前・条件が入っているか？
- [ ] 「適切に」「必要に応じて」などの曖昧ワードを使っていないか？
- [ ] 他の人が読んでも同じ解釈になるか？
- [ ] 「なぜその決定をしたか」の理由も書いたか？

---

## 認識合わせのテンプレート

### 基本形

```
「〇〇という理解で合ってる？」
「つまり、□□ということでOK？」
「整理すると、△△で進めていい？」
```

### 複数項目がある場合

```
「ここまでの認識を整理すると：
1. 〇〇は□□
2. △△は××
3. ◇◇は対象外

この理解で合ってる？」
```

### 曖昧さが残る場合

```
「〇〇については□□と理解したけど、
△△の部分がまだ曖昧かも。
具体的には××ってこと？それとも◇◇？」
```

---

## 認識合わせ前の必須チェック

認識合わせを行う前に、以下を自己チェックすること。

### 1. 論点の網羅性

**確認ポイント:**
- 議論から派生する関連トピックを見落としていないか？
- 影響範囲を十分に考慮しているか？
- 「他に決めるべきことはないか？」と自問したか？

**NGパターン:**
- 目の前の論点だけ確認して、関連する論点を放置
- 「とりあえずこれだけ決めよう」で重要な論点を先送り

### 2. 前提の確認

**確認ポイント:**
- ユーザーの発言の背後にある前提を正しく理解しているか？
- 技術的な制約や要件を見落としていないか？
- 暗黙の前提を明示的に確認したか？

**NGパターン:**
- ユーザーの言葉をそのまま受け取り、意図を確認しない
- 「たぶんこういう意味だろう」で進める

### 3. 性急な結論の回避

**確認ポイント:**
- 代替案を少なくとも1つは検討したか？
- トレードオフを明確にしたか？
- 「本当にこれでいい？」と一度立ち止まったか？

**NGパターン:**
- 最初に出た案をそのまま採用
- 「これしかない」と決めつける
